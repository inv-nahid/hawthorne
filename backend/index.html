<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Razorpay Payment</title>
</head>
<body>
  <h1>Razorpay Payment Gateway</h1>
  <form id="payment-form">
    <label for="amount">Amount (â‚¹):</label>
    <input type="number" id="amount" name="amount" required>
    <button type="button" id="pay-btn">Pay Now</button>
  </form>

  <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
  <script>
    //localStorage.getItem('token'); // JWT token
    const token ="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4Y2IzMDhjOGNkMzQ5YTQxMjE2NzcwOCIsImlhdCI6MTc1ODU3OTcwMywiZXhwIjoxNzU5MTg0NTAzfQ.FoaxS4o8BnW8x2FFvnVpWImG6swdzJG4G1GZa9QvwM4"

    document.getElementById('pay-btn').addEventListener('click', payNow)
    
    async function payNow() {
      const amount = document.getElementById('amount').value;

      // 1. Create order in backend
      const response = await fetch('http://localhost:4000/api/order/place', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${token}`}, 
        body: JSON.stringify({ 
          amount: Number(amount),
          paymentMethod: 'Card', // or 'COD'
          items: [], // add selected food items here
          address: {} // add delivery address here
        })
      });

      const data = await response.json();
      const razorpayOrderId = data.razorpayOrder.id;

      // 2. Open Razorpay Checkout
      const options = {
        key: 'YOUR_KEY_ID', // replace with your Razorpay key_id
        amount: amount * 100, // in paise
        currency: 'INR',
        name: 'Your Restaurant Name',
        description: 'Food Order Payment',
        order_id: razorpayOrderId, // dynamic from backend
        callback_url: 'http://localhost:4000/payment-success', // success page
        prefill: {
          name: '', // optionally populate with user data
          email: '',
          contact: ''
        },
        theme: { color: '#F37254' },
      };

      const rzp = new Razorpay(options);
      rzp.open();
    }
  </script>
</body>
</html>
